<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bean There ‚Äì Profile</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&family=Lora:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #efe8d6;
      --sidebar: #5b5f10;
      --accent: #7f7b2e;
      --muted: #bfb0a8;
      --content-width: 1100px; /* reduced so search + avatar fit */
    }

    *{box-sizing:border-box}
    html,body{
      height:100%;
      margin:0;
      font-family:Montserrat, system-ui, sans-serif;
      background:var(--bg);
      color:#2b2b2b;
    }

    .frame{
      width:100%;
      height:100vh;
      overflow:hidden;
    }

    .layout{
      display:grid;
      grid-template-columns:260px 1fr;
      height:100%;
      column-gap:18px;
    }

    /* SIDEBAR */
    .sidebar{
      background:var(--sidebar);
      color:#fff;
      padding:28px;
      margin:18px 0 18px 18px;
      border-radius:22px;
      height:calc(100% - 36px);
      display:flex;
      flex-direction:column;
      justify-content:space-between;
    }

    .logo{
      font-family:Lora, serif;
      font-size:42px;
      font-weight:700;
      letter-spacing:1px;
    }

    .nav{
      margin-top:36px;
      display:flex;
      flex-direction:column;
      gap:26px;
    }

    .nav a{
      color:#fff;
      text-decoration:none;
      font-size:20px;
    }

    .auth{font-size:20px}

    .sidebar .nav a:hover,
    .sidebar .auth div:hover{
      color:#fa7a11;
      cursor:pointer;
      transition:0.3s;
    }
    /* Animation Keyframes */
@keyframes floatUp {
  from { opacity: 0; transform: translateY(40px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Animation Classes */
.animate-on-load {
  opacity: 0;
  animation: floatUp 0.9s ease-out forwards;
}

.delay-1 { animation-delay: 0.15s; }
.delay-2 { animation-delay: 0.35s; }

    /* MAIN */
    .main{
      height:calc(100% - 36px);
      margin:18px 18px 0 0;
      padding:32px 22px;
      border:1.5px solid rgba(127,123,46,0.4);
      border-radius:24px;
      overflow-y:auto;
      position:relative;
    }

    /* search + mini avatar row */
    .search-row{
      display:flex;
    justify-content:center;           /* center the whole search-area on page */
    margin-bottom:26px;
    }
    .search-area{
    width:100%;
    max-width:var(--content-width);   /* center area width (same as content) */
    display:flex;
    align-items:center;
    justify-content:center;           /* will center children but we control widths */
    gap:16px;
    padding:0 12px;                   /* small padding to avoid edge touching */
    position:relative;
    }

    .search{
    flex: 1 1 calc(100% - 84px);      /* leave ~84px for avatar + gap */
    max-width: calc(var(--content-width) - 84px);
    padding:14px 18px;
    border-radius:40px;
    border:1.5px solid rgba(127,123,46,0.4);
    background:transparent;
    display:flex;
    align-items:center;
    box-shadow: 0 2px 0 rgba(0,0,0,0.02) inset;
    }

    .search input{
      flex:1;
      border:0;
      background:transparent;
      outline:none;
      font-size:18px;
    }

    .search button{
      border:0;
      background:transparent;
      font-size:20px;
      cursor:pointer;
    }
    /* modal avatar preview small tweaks */
#modalAvatarPreview{ border-radius:50%; display:block; }
#inputAvatar{ font-size:14px; }
#removeAvatarBtn{ background:transparent; }
#removeAvatarBtn:hover{ background:rgba(0,0,0,0.04); }

    /* Modal for Edit Profile */
.modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:1600; }
.modal[hidden]{ display:none; }
.modal-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,0.22); border-radius:12px; }
.modal-panel{
  position:relative;
  background: #fff;
  width: min(680px, calc(100% - 48px));
  border-radius:12px;
  padding:18px;
  box-shadow: 0 18px 40px rgba(0,0,0,0.18);
  border:1px solid rgba(0,0,0,0.06);
  z-index:2;
  font-family: inherit;
}

/* small utility classes */
.modal-close{ background:transparent;border:0;font-size:18px;cursor:pointer;padding:6px; }
.btn-secondary:hover{ background: rgba(0,0,0,0.04); }
.btn-primary{ background:var(--accent); color:#fff; border-radius:8px; }

/* ensure form controls readable on small screens */
@media(max-width:520px){
  .modal-panel{ width: calc(100% - 32px); padding:14px; }
}


    /* small avatar in top-right of the content area */
    .user-mini{
      width:56px;
    height:56px;
    border-radius:50%;
    overflow:hidden;
    border:3px solid rgba(127,123,46,0.15);
    background:#fff;
    flex:0 0 56px;
    display:block;
    }
    .user-mini img{ width:100%; height:100%; object-fit:cover; display:block; }

    /* PROFILE HEADER */
    .profile-header{
      display:flex;
      align-items:flex-start;
      gap:22px;
      max-width:var(--content-width);
      margin:6px auto 30px;
    }

    .avatar-large{
      width:120px;
      height:120px;
      border-radius:50%;
      overflow:hidden;
      border:8px solid #dfe7e5;
      background:#fff;
      flex:0 0 120px;
    }
    .avatar-large img{ width:100%; height:100%; object-fit:cover; display:block; }

    .profile-meta{
      flex:1;
    }
    .profile-meta h1{
      margin-top: 8px; /* Adjust this value (e.g., 2px to 8px) to taste */
  margin-bottom: 0;
  font-size: 44px;
  line-height: 1;
  font-weight: 700;
  letter-spacing: -0.5px;
    }
    .profile-meta .handle{
      color:#2b5b6f;
      margin-top:6px;
      font-size:16px;
      font-weight:600;
    }
    .profile-meta p{
      margin:10px 0 0;
      color:var(--muted);
    }

    .edit-btn{
      display:inline-block;
      margin-top:12px;
      padding:8px 16px;
      border-radius:20px;
      border:1.5px solid rgba(127,123,46,0.4);
      background:transparent;
      cursor:pointer;
      font-weight:600;
    }

    /* Sections */
    .section{
      max-width:var(--content-width);
      margin:28px auto;
      text-align:center;
    }
    .section h2{
      font-size:32px;
      margin:0 0 18px;
      letter-spacing:-0.3px;
    }
    /* ----- user dropdown ----- */
.user-menu{ position:relative; display:inline-block; flex:0 0 auto; }
.user-mini-btn{
  width:56px; height:56px; border-radius:50%; padding:0; border:3px solid rgba(127,123,46,0.15);
  background:#fff; display:inline-flex; align-items:center; justify-content:center; cursor:pointer;
}
.user-mini-btn img{ display:block; width:100%; height:100%; object-fit:cover; border-radius:50%; }

/* dropdown panel */
.user-dropdown{
  position:absolute;
  top:calc(100% + 12px);
  right:0;
  width:270px;
  background:#fff;
  border-radius:12px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.12);
  border:1px solid rgba(0,0,0,0.06);
  padding:10px;
  z-index:1200;
  font-size:15px;
}

/* header */
.ud-header{ padding:8px 10px; text-align:left; }
.ud-greet{ font-weight:700; color:#111; font-size:15px; }
.ud-sub{ color:#6b6b6b; margin-top:4px; font-size:13px; }

/* divider */
.ud-divider{ height:1px; background:rgba(0,0,0,0.06); margin:8px 0; border-radius:2px; }

/* list */
.ud-list{ list-style:none; padding:0; margin:0; }
.ud-item{
  width:100%;
  text-align:left;
  background:transparent;
  border:0;
  padding:10px;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
}
.ud-item:hover{ background:rgba(127,123,46,0.06); }

/* signout */
.ud-signout{ padding:8px 10px; text-align:left; }
.ud-signout-btn{
  width:100%;
  background:transparent;
  border:0;
  padding:10px;
  border-radius:8px;
  color:#111;
  cursor:pointer;
  font-weight:700;
}
.ud-signout-btn:hover{ background:rgba(255,80,60,0.06); }

/* small screens: keep dropdown within viewport */
@media(max-width:520px){
  .user-dropdown{ right:8px; left:8px; width:auto; }
}


    /* carousel placeholder */
    .carousel{
      background: #cfe0ff;
      border-radius:16px;
      padding:28px;
      position:relative;
      height:110px;
      display:flex;
      align-items:center;
      justify-content:center;
      margin:0 48px;
    }

    .carousel .arrow{
      position:absolute;
      width:44px;
      height:44px;
      border-radius:50%;
      background:#ee6a45;
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      cursor:pointer;
      top:50%;
      transform:translateY(-50%);
      box-shadow: 0 4px 8px rgba(0,0,0,0.12);
    }
    .carousel .arrow.left{ left: -22px; }
    .carousel .arrow.right{ right: -22px; }

    /* replies carousel larger height */
    .carousel.large{ height:150px; }

    @media(max-width:980px){
    :root{ --content-width: 820px; }
    .search{ flex:1 1 calc(100% - 64px); max-width: calc(var(--content-width) - 64px); }
    .user-mini{ width:48px; height:48px; flex:0 0 48px; }
  }

  @media(max-width:760px){
    .layout{grid-template-columns:1fr}
    .sidebar{order:2;height:auto}
    .main{order:1}
    .user-mini{ display:none; } /* hide mini on very small screens */
  }
  </style>
</head>

<body>
  <div class="frame">
    <div class="layout">

      <aside class="sidebar animate-on-load delay-1">
        <div>
          <div class="logo">bean<br>there</div>
          <nav class="nav">
            <a href="/bean there/index.html">Home</a>
            <a href="/bean there/profile.html">Profile</a>
            <a href="/bean there/tbv.html">TBV</a>
            <a href="/bean there/ratings.html">Ratings</a>
          </nav>
        </div>
        <div class="auth">
          <div style="margin-bottom:14px">Log in</div>
          <div>Sign up</div>
        </div>
      </aside>

      <main class="main animate-on-load delay-2">

        <!-- search row + small profile pic on the top-right -->
        <div class="search-row">
  <div class="search-area" role="search" aria-label="Search cafes owners tags">
    <div class="search" aria-hidden="false">
      <input id="q" placeholder="Search cafes, owners, tags..." />
      <button id="searchBtn" aria-label="Search">üîç</button>
    </div>

    <!-- mini avatar placed inline (no absolute positioning) -->
    <!-- user menu: replace your old <a class="user-mini"> ... -->
<div class="user-menu" id="userMenu">
  <button id="userMenuBtn" class="user-mini-btn" aria-haspopup="true" aria-expanded="false" aria-controls="userDropdown" title="Open account menu">
    <img id="avatarMiniImg"src="icons/noprof.jpg" alt="profile mini">
  </button>

  <div id="userDropdown" class="user-dropdown" role="menu" aria-labelledby="userMenuBtn" hidden>
    <div class="ud-header">
      <div class="ud-greet">Hi, Erylle Jerica Galinato!</div>
      <div class="ud-sub">Student</div>
    </div>

    <div class="ud-divider" role="separator"></div>

    <ul class="ud-list" role="menu">
      <li role="none"><button role="menuitem" class="ud-item" data-action="profile">Profile</button></li>
      <li role="none"><button role="menuitem" class="ud-item" data-action="contact">Contact Us</button></li>
      <li role="none"><button role="menuitem" class="ud-item" data-action="support">Support Us</button></li>
    </ul>

    <div class="ud-divider" role="separator"></div>

    <div class="ud-signout">
      <button role="menuitem" class="ud-signout-btn" data-action="signout">Sign Out</button>
    </div>
  </div>
</div>

  </div>
</div>

        <!-- big profile header -->
        <div class="profile-header">
          <div class="avatar-large">
  <img id="avatarLargeImg" src="icons/noprof.jpg" alt="profile large">
</div>
          <!-- Edit Profile Modal (paste after the profile header) -->
<!-- Edit Profile Modal (with avatar upload) -->
<div id="editProfileModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" hidden>
  <div class="modal-backdrop" data-close></div>

  <div class="modal-panel" role="document">
    <header style="display:flex;align-items:center;justify-content:space-between;">
      <h3 id="modalTitle" style="margin:0">Edit profile</h3>
      <button class="modal-close" aria-label="Close" data-close>‚úï</button>
    </header>

    <form id="editProfileForm" style="margin-top:14px;">
      <!-- Avatar upload row -->
      <div style="display:flex;gap:14px;align-items:center;">
        <div style="flex:0 0 auto; text-align:center;">
          <div style="width:84px; height:84px; border-radius:50%; overflow:hidden; border:2px solid #e6eaea; display:inline-block;">
  <img id="modalAvatarPreview" src="icons/noprof.jpg" alt="preview" style="width:100%; height:100%; object-fit:cover; display:block;">
</div>
        </div>

        <div style="flex:1;">
          <label for="inputAvatar" style="display:block;font-weight:600;margin-bottom:6px;">Profile picture</label>
          <input id="inputAvatar" type="file" accept="image/*" />
          <div id="avatarHelp" style="font-size:13px;color:#666;margin-top:6px;">PNG/JPG, max 3 MB. Preview shown above.</div>

          <div style="margin-top:8px;">
            <button type="button" id="removeAvatarBtn" style="padding:6px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);background:transparent;cursor:pointer;">Remove photo</button>
          </div>
        </div>
      </div>

      <!-- Username + Bio -->
      <label for="inputUsername" style="display:block;margin-top:14px;margin-bottom:6px;font-weight:600;">Username</label>
      <input id="inputUsername" type="text" placeholder="@your_username" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.12);font-size:15px;" required>
      <label for="inputTitle" style="display:block;margin-top:12px;margin-bottom:6px;font-weight:600;">Job Title</label>
<input id="inputTitle" type="text" placeholder="Job Title" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.12);font-size:15px;">

      <label for="inputBio" style="display:block;margin-top:12px;margin-bottom:6px;font-weight:600;">Short bio</label>
      <textarea id="inputBio" rows="4" placeholder="Write a short bio..." style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.12);font-size:15px;"></textarea>

      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:14px;">
        <button type="button" class="btn-secondary" data-close style="padding:8px 12px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);background:transparent;cursor:pointer;">Cancel</button>
        <button type="submit" class="btn-primary" style="padding:8px 14px;border-radius:8px;border:0;background:var(--accent);color:#fff;cursor:pointer;font-weight:700;">Save</button>
      </div>
    </form>
  </div>
</div>



          <!-- REPLACE your existing .profile-meta block with this -->
<div class="profile-meta">
  <h1>Erylle Galinato</h1>
  <div id="handleText" class="handle">@erylle_g</div>
  <p id="bioText">Placeholder for short bio ‚Äî add a couple of lines about yourself here.</p>
  <button id="editProfileBtn" class="edit-btn" aria-haspopup="dialog" aria-controls="editProfileModal">Edit Profile</button>
</div>

        </div>

        <!-- Content sections -->
        <section class="section">
          <h2>My reviews</h2>
          <div class="carousel" aria-hidden="false">
            <div class="arrow left" onclick="alert('prev')">‚Äπ</div>
            <div class="arrow right" onclick="alert('next')">‚Ä∫</div>
            <!-- placeholder content -->
            <div style="opacity:.9; font-weight:600; color:#123456;">(Your reviews will appear here)</div>
          </div>
        </section>

        <section class="section">
          <h2>Replies to other reviews</h2>
          <div class="carousel large" aria-hidden="false">
            <div class="arrow left" onclick="alert('prev')">‚Äπ</div>
            <div class="arrow right" onclick="alert('next')">‚Ä∫</div>
            <div style="opacity:.9; font-weight:600; color:#123456;">(Replies and interactions appear here)</div>
          </div>
        </section>

      </main>

    </div>
  </div>

  <script>
    (function(){
  const editBtn = document.getElementById('editProfileBtn');
  const modal = document.getElementById('editProfileModal');
  const closeTriggers = modal ? modal.querySelectorAll('[data-close]') : [];
  const form = document.getElementById('editProfileForm');
  const inputUsername = document.getElementById('inputUsername');
  const inputBio = document.getElementById('inputBio');
  const handleText = document.getElementById('handleText');
  const bioText = document.getElementById('bioText');
// AVATAR ELEMENTS
  const modalPreview = document.getElementById('modalAvatarPreview'); // preview inside modal
  const inputAvatar = document.getElementById('inputAvatar');
  const removeAvatarBtn = document.getElementById('removeAvatarBtn');
  const avatarLarge = document.getElementById('avatarLargeImg'); // big avatar on page
  const avatarMini = document.getElementById('avatarMiniImg');
  // Helpers for localStorage keys
  const LS_USER = 'beanthere_profile_username';
  const LS_BIO = 'beanthere_profile_bio';
  const LS_AVATAR = 'beanthere_profile_avatar'; // stores data URL

 // Update these two lines specifically
const DEFAULT_LARGE_SRC = avatarLarge ? avatarLarge.getAttribute('src') || 'icons/noprof.jpg' : 'icons/noprof.jpg';
const DEFAULT_MINI_SRC  = avatarMini ? avatarMini.getAttribute('src') || 'icons/noprof.jpg' : 'icons/noprof.jpg';
  // Load saved values on startup (if any)
 function loadSaved(){
    // Keys used in your Sign Up function
    const LS_NAME   = 'beanthere_profile_fullname';
    const LS_USER   = 'beanthere_profile_username';
    const LS_BIO    = 'beanthere_profile_bio';
    const LS_AVATAR = 'beanthere_profile_avatar';
    const LS_TITLE = 'beanthere_profile_title';
    const savedTitle = localStorage.getItem(LS_TITLE);

    const savedName   = localStorage.getItem(LS_NAME);
    const savedUser   = localStorage.getItem(LS_USER);
    const savedBio    = localStorage.getItem(LS_BIO);
    const savedAvatar = localStorage.getItem(LS_AVATAR);

    const dropdownSub = document.querySelector('.ud-sub');
    if(savedTitle && dropdownSub) {
    dropdownSub.textContent = savedTitle;
    }
    // 1. Update Full Name (the <h1> tag)
    const nameHeading = document.querySelector('.profile-meta h1');
    if(savedName && nameHeading) {
      nameHeading.textContent = savedName;
      // Also update the greeting in the dropdown menu
      const dropdownGreet = document.querySelector('.ud-greet');
      if(dropdownGreet) dropdownGreet.textContent = `Hi, ${savedName}!`;
    }

    // 2. Update Username/Handle
    if(savedUser && handleText) handleText.textContent = savedUser;

    // 3. Update Bio
    if(savedBio && bioText) bioText.textContent = savedBio;

    // 4. Update Avatars
    if(savedAvatar && avatarLarge && avatarMini){
      avatarLarge.src = savedAvatar;
      avatarMini.src = savedAvatar;
      if(modalPreview) modalPreview.src = savedAvatar;
    } else {
      // Revert to default if no avatar is saved
      if(avatarLarge) avatarLarge.src = DEFAULT_LARGE_SRC;
      if(avatarMini)  avatarMini.src  = DEFAULT_MINI_SRC;
      if(modalPreview) modalPreview.src = DEFAULT_LARGE_SRC;
    }
  }

  loadSaved();

  // fill modal inputs with current values before opening
  function openModal(){
    if(!modal) return;
    inputUsername.value = (handleText && handleText.textContent) ? handleText.textContent : '';
    inputBio.value = (bioText && bioText.textContent) ? bioText.textContent : '';
    // preview should already be set from loadSaved
    modal.hidden = false;
    setTimeout(()=> inputUsername.focus(), 30);
  }

  function closeModal(){
    if(!modal) return;
    modal.hidden = true;
    editBtn.focus();
    // clear file input selection (not the preview)
    if(inputAvatar) inputAvatar.value = '';
  }

  function normalizeUsername(val){
    if(!val) return '';
    val = val.trim();
    if(val.length === 0) return '';
    if(val.charAt(0) !== '@') return '@' + val;
    return val;
  }
   // file validation and preview
  if(inputAvatar){
    inputAvatar.addEventListener('change', function(e){
      const file = inputAvatar.files && inputAvatar.files[0];
      if(!file) return;

      // validate type (image) and size (limit: 3 MB)
      const maxBytes = 3 * 1024 * 1024; // 3 MB
      if(!file.type.startsWith('image/')){
        alert('Please choose an image file (png, jpg, gif).');
        inputAvatar.value = '';
        return;
      }
      if(file.size > maxBytes){
        alert('Image too large. Please pick an image under 3 MB.');
        inputAvatar.value = '';
        return;
      }

      const reader = new FileReader();
      reader.onload = function(ev){
        const dataUrl = ev.target.result;
        // show modal preview immediately
        if(modalPreview) modalPreview.src = dataUrl;
        // optionally autosave preview to localStorage? we'll save on form submit
      };
      reader.readAsDataURL(file);
    });
  }
 if(removeAvatarBtn){
    removeAvatarBtn.addEventListener('click', function(e){
      e.preventDefault();
      // clear saved avatar in localStorage
      try{ localStorage.removeItem(LS_AVATAR); } catch(err){ console.warn(err); }
      // revert images to original defaults
      if(avatarLarge) avatarLarge.src = DEFAULT_LARGE_SRC;
      if(avatarMini) avatarMini.src = DEFAULT_MINI_SRC;
      if(modalPreview) modalPreview.src = DEFAULT_LARGE_SRC;
      // also clear file selection
      if(inputAvatar) inputAvatar.value = '';
      alert('Profile photo removed (reverted to default).');
    });
  }

  // Event bindings
   editBtn.addEventListener('click', function(e){ e.preventDefault(); openModal(); });
  closeTriggers.forEach(btn => btn.addEventListener('click', function(e){ e.preventDefault(); closeModal(); }));
  modal.addEventListener('click', function(e){
    if(e.target === modal.querySelector('.modal-backdrop')) closeModal();
  });
  document.addEventListener('keydown', function(e){ if(e.key === 'Escape' && !modal.hidden) closeModal(); });

  

  // handle submit
  form.addEventListener('submit', function(e){
    e.preventDefault();
    const titleVal = document.getElementById('inputTitle').value || 'Member';
    localStorage.setItem('beanthere_profile_title', titleVal);
    if(document.querySelector('.ud-sub')) document.querySelector('.ud-sub').textContent = titleVal;
    let usernameVal = inputUsername.value || '';
    let bioVal = inputBio.value || '';
    usernameVal = normalizeUsername(usernameVal);
    if(usernameVal.length < 2){
      alert('Please enter a valid username (e.g. @erylle_g).');
      inputUsername.focus();
      return;
    }
    // update DOM
     if(handleText) handleText.textContent = usernameVal;
    if(bioText) bioText.textContent = bioVal;

    // Save username + bio
    try{
      localStorage.setItem(LS_USER, usernameVal);
      localStorage.setItem(LS_BIO, bioVal);
    }catch(err){ console.warn('Could not save to localStorage:', err); }
     const file = inputAvatar.files && inputAvatar.files[0];
    if(file){
      const reader = new FileReader();
      reader.onload = function(ev){
        const dataUrl = ev.target.result;
        // Update both avatar images
        if(avatarLarge) avatarLarge.src = dataUrl;
        if(avatarMini) avatarMini.src = dataUrl;
        if(modalPreview) modalPreview.src = dataUrl;
        // save to localStorage
        try{ localStorage.setItem(LS_AVATAR, dataUrl); } catch(err){ console.warn(err); }
      };
      reader.readAsDataURL(file);
    }
    
    closeModal();
  });
  window.addEventListener('DOMContentLoaded', loadSaved);
})();
    // example: keep search click working (you can add real search logic)
    document.getElementById('searchBtn').addEventListener('click', function () {
      const q = document.getElementById('q').value.trim();
      alert(q ? 'Searching for: ' + q : 'Please type a search term');
    });
    (function(){
    const btn = document.getElementById('userMenuBtn');
    const panel = document.getElementById('userDropdown');

    function openPanel(){ 
      panel.hidden = false; 
      btn.setAttribute('aria-expanded','true');
      // put focus on first menu element for keyboard users
      const first = panel.querySelector('[role="menuitem"]');
      if(first) first.focus();
    }
    function closePanel(){ 
      panel.hidden = true; 
      btn.setAttribute('aria-expanded','false'); 
      btn.focus();
    }
    function togglePanel(){
      if(panel.hidden) openPanel(); else closePanel();
    }

    // toggle when clicking the avatar button
    btn.addEventListener('click', function(e){
      e.stopPropagation();
      togglePanel();
    });

    // Close on outside click
    document.addEventListener('click', function(e){
      if(!panel.hidden && !panel.contains(e.target) && !btn.contains(e.target)){
        closePanel();
      }
    });

    // Close on Escape key
    document.addEventListener('keydown', function(e){
      if(e.key === 'Escape' && !panel.hidden){ closePanel(); }
    });

    // handle menu actions
    panel.addEventListener('click', function(e){
      const actionBtn = e.target.closest('button[data-action]');
      if(!actionBtn) return;
      const action = actionBtn.getAttribute('data-action');

      if(action === 'profile') {
        window.location.href = 'profile.html';
      } else if(action === 'contact') {
        window.location.href = 'contact.html'; // change target if you have a different page
      } else if(action === 'support') {
        window.location.href = 'support.html'; // change target as needed
      } else if(action === 'signout') {
        // sign out -> redirect to homepage (index.html)
        window.location.href = 'index.html';
      }
    });

    // allow keyboard activation of button (space/enter is default for button)
    // optional: trap focus inside dropdown while open (simple approach)
    panel.addEventListener('keydown', function(e){
      const focusable = Array.from(panel.querySelectorAll('[role="menuitem"]'));
      if(!focusable.length) return;

      const idx = focusable.indexOf(document.activeElement);
      if(e.key === 'ArrowDown'){
        e.preventDefault();
        const next = focusable[(idx + 1) % focusable.length];
        next.focus();
      } else if(e.key === 'ArrowUp'){
        e.preventDefault();
        const prev = focusable[(idx - 1 + focusable.length) % focusable.length];
        prev.focus();
      }
    });
  })();
  </script>
</body>
</html>
